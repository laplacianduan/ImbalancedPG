# if(i>100)
trace_beta<- rbind(trace_beta, t(beta))
}
# acf(trace_beta[,2],lag.max = 40)
#
ts.plot(trace_beta[,1])
# ts.plot(trace_beta[,2])
# acf(trace_beta[,1],lag.max = 40)
X2inv<- solve(t(X)%*%X)
cholX2inv<- t(chol(X2inv))
lb<- -vecInf
ub<- vecInf
lb[y==1]<- 0
ub[y==0]<- 0
# pnorm(qnorm(1/N))
# pnorm(qnorm(1/N), b, sqrt(r))
# r<- 0.1
r<- 10
# r<-1
# beta<- c(-4,0)
# b <- X%*%beta * (1 - 1*sqrt(r))
# pnorm(Xbeta)- pnorm(Xbeta, b, sqrt(r))
beta<- c(0,0)
trace_beta<- numeric()
for(i in 1:200){
Xbeta  <- X%*%beta
# b <-  log(r)*(1 - 1*sqrt(r))
theta<- Xbeta
Z<- rtnorm(N, theta,sd = sqrt(r), lb, ub )
m<- X2inv%*% (t(X)%*% (Z))
beta <- cholX2inv%*%rnorm(2)*sqrt(r) + m
# if(i>100)
trace_beta<- rbind(trace_beta, t(beta))
}
# acf(trace_beta[,2],lag.max = 40)
#
ts.plot(trace_beta[,1])
# ts.plot(trace_beta[,2])
# acf(trace_beta[,1],lag.max = 40)
X2inv<- solve(t(X)%*%X)
cholX2inv<- t(chol(X2inv))
lb<- -vecInf
ub<- vecInf
lb[y==1]<- 0
ub[y==0]<- 0
# pnorm(qnorm(1/N))
# pnorm(qnorm(1/N), b, sqrt(r))
# r<- 0.1
r<- 10
# r<-1
# beta<- c(-4,0)
# b <- X%*%beta * (1 - 1*sqrt(r))
# pnorm(Xbeta)- pnorm(Xbeta, b, sqrt(r))
beta<- c(0,0)
trace_beta<- numeric()
for(i in 1:200){
Xbeta  <- X%*%beta
# b <-  log(r)*(1 - 1*sqrt(r))
theta<- Xbeta
Z<- rtnorm(N, theta,sd = sqrt(r), lb, ub )
m<- X2inv%*% (t(X)%*% (Z))
beta <- cholX2inv%*%rnorm(2)*sqrt(r) + m
# if(i>100)
trace_beta<- rbind(trace_beta, t(beta))
}
# acf(trace_beta[,2],lag.max = 40)
#
ts.plot(trace_beta[,1])
# ts.plot(trace_beta[,2])
# acf(trace_beta[,1],lag.max = 40)
X2inv<- solve(t(X)%*%X)
cholX2inv<- t(chol(X2inv))
lb<- -vecInf
ub<- vecInf
lb[y==1]<- 0
ub[y==0]<- 0
# pnorm(qnorm(1/N))
# pnorm(qnorm(1/N), b, sqrt(r))
# r<- 0.1
r<- 10
# r<-1
# beta<- c(-4,0)
# b <- X%*%beta * (1 - 1*sqrt(r))
# pnorm(Xbeta)- pnorm(Xbeta, b, sqrt(r))
beta<- c(0,0)
trace_beta<- numeric()
for(i in 1:200){
Xbeta  <- X%*%beta
# b <-  log(r)*(1 - 1*sqrt(r))
theta<- Xbeta
Z<- rtnorm(N, theta,sd = sqrt(r), lb, ub )
m<- X2inv%*% (t(X)%*% (Z))
beta <- cholX2inv%*%rnorm(2)*sqrt(r) + m
# if(i>100)
trace_beta<- rbind(trace_beta, t(beta))
}
# acf(trace_beta[,2],lag.max = 40)
#
ts.plot(trace_beta[,1])
# ts.plot(trace_beta[,2])
# acf(trace_beta[,1],lag.max = 40)
X2inv<- solve(t(X)%*%X)
cholX2inv<- t(chol(X2inv))
lb<- -vecInf
ub<- vecInf
lb[y==1]<- 0
ub[y==0]<- 0
# pnorm(qnorm(1/N))
# pnorm(qnorm(1/N), b, sqrt(r))
# r<- 0.1
r<- 10
# r<-1
# beta<- c(-4,0)
# b <- X%*%beta * (1 - 1*sqrt(r))
# pnorm(Xbeta)- pnorm(Xbeta, b, sqrt(r))
beta<- c(0,0)
trace_beta<- numeric()
for(i in 1:200){
Xbeta  <- X%*%beta
# b <-  log(r)*(1 - 1*sqrt(r))
theta<- Xbeta
Z<- rtnorm(N, theta,sd = sqrt(r), lb, ub )
m<- X2inv%*% (t(X)%*% (Z))
beta <- cholX2inv%*%rnorm(2)*sqrt(r) + m
# if(i>100)
trace_beta<- rbind(trace_beta, t(beta))
}
# acf(trace_beta[,2],lag.max = 40)
#
ts.plot(trace_beta[,1])
# ts.plot(trace_beta[,2])
# acf(trace_beta[,1],lag.max = 40)
X0<- 1#rnorm(N, 1, 1)
X1<- rnorm(N, 1, 1)
X<- cbind(X0,X1)
beta<- c(-3,0)
theta<- pnorm(X%*%beta)
y<- as.numeric( runif(N)<theta)
sum(y)
vecInf<- rep(Inf, N)
X2inv<- solve(t(X)%*%X)
cholX2inv<- t(chol(X2inv))
lb<- -vecInf
ub<- vecInf
lb[y==1]<- 0
ub[y==0]<- 0
# pnorm(qnorm(1/N))
# pnorm(qnorm(1/N), b, sqrt(r))
# r<- 0.1
r<- 10
# r<-1
# beta<- c(-4,0)
# b <- X%*%beta * (1 - 1*sqrt(r))
# pnorm(Xbeta)- pnorm(Xbeta, b, sqrt(r))
beta<- c(0,0)
trace_beta<- numeric()
for(i in 1:200){
Xbeta  <- X%*%beta
# b <-  log(r)*(1 - 1*sqrt(r))
theta<- Xbeta
Z<- rtnorm(N, theta,sd = sqrt(r), lb, ub )
m<- X2inv%*% (t(X)%*% (Z))
beta <- cholX2inv%*%rnorm(2)*sqrt(r) + m
# if(i>100)
trace_beta<- rbind(trace_beta, t(beta))
}
# acf(trace_beta[,2],lag.max = 40)
#
ts.plot(trace_beta[,1])
# ts.plot(trace_beta[,2])
# acf(trace_beta[,1],lag.max = 40)
X0<- 1#rnorm(N, 1, 1)
X1<- rnorm(N, 1, 1)
X<- cbind(X0,X1)
beta<- c(-3,0)
theta<- pnorm(X%*%beta)
y<- as.numeric( runif(N)<theta)
sum(y)
vecInf<- rep(Inf, N)
X2inv<- solve(t(X)%*%X)
cholX2inv<- t(chol(X2inv))
lb<- -vecInf
ub<- vecInf
lb[y==1]<- 0
ub[y==0]<- 0
# pnorm(qnorm(1/N))
# pnorm(qnorm(1/N), b, sqrt(r))
# r<- 0.1
r<- 10
# r<-1
# beta<- c(-4,0)
# b <- X%*%beta * (1 - 1*sqrt(r))
# pnorm(Xbeta)- pnorm(Xbeta, b, sqrt(r))
beta<- c(0,0)
trace_beta<- numeric()
for(i in 1:200){
Xbeta  <- X%*%beta
# b <-  log(r)*(1 - 1*sqrt(r))
theta<- Xbeta
Z<- rtnorm(N, theta,sd = sqrt(r), lb, ub )
m<- X2inv%*% (t(X)%*% (Z))
beta <- cholX2inv%*%rnorm(2)*sqrt(r) + m
# if(i>100)
trace_beta<- rbind(trace_beta, t(beta))
}
# acf(trace_beta[,2],lag.max = 40)
#
ts.plot(trace_beta[,1])
# ts.plot(trace_beta[,2])
# acf(trace_beta[,1],lag.max = 40)
X0<- 1#rnorm(N, 1, 1)
X1<- rnorm(N, 1, 1)
X<- cbind(X0,X1)
beta<- c(-3,0)
theta<- pnorm(X%*%beta)
y<- as.numeric( runif(N)<theta)
sum(y)
vecInf<- rep(Inf, N)
X2inv<- solve(t(X)%*%X)
cholX2inv<- t(chol(X2inv))
lb<- -vecInf
ub<- vecInf
lb[y==1]<- 0
ub[y==0]<- 0
# pnorm(qnorm(1/N))
# pnorm(qnorm(1/N), b, sqrt(r))
# r<- 0.1
r<- 10
# r<-1
# beta<- c(-4,0)
# b <- X%*%beta * (1 - 1*sqrt(r))
# pnorm(Xbeta)- pnorm(Xbeta, b, sqrt(r))
beta<- c(0,0)
trace_beta<- numeric()
for(i in 1:200){
Xbeta  <- X%*%beta
# b <-  log(r)*(1 - 1*sqrt(r))
theta<- Xbeta
Z<- rtnorm(N, theta,sd = sqrt(r), lb, ub )
m<- X2inv%*% (t(X)%*% (Z))
beta <- cholX2inv%*%rnorm(2)*sqrt(r) + m
# if(i>100)
trace_beta<- rbind(trace_beta, t(beta))
}
# acf(trace_beta[,2],lag.max = 40)
#
ts.plot(trace_beta[,1])
# ts.plot(trace_beta[,2])
# acf(trace_beta[,1],lag.max = 40)
N<- 100
X0<- 1#rnorm(N, 1, 1)
X1<- rnorm(N, 1, 1)
X<- cbind(X0,X1)
beta<- c(-3,0)
theta<- pnorm(X%*%beta)
y<- as.numeric( runif(N)<theta)
sum(y)
vecInf<- rep(Inf, N)
X2inv<- solve(t(X)%*%X)
cholX2inv<- t(chol(X2inv))
lb<- -vecInf
ub<- vecInf
lb[y==1]<- 0
ub[y==0]<- 0
# pnorm(qnorm(1/N))
# pnorm(qnorm(1/N), b, sqrt(r))
# r<- 0.1
r<- 1
# r<-1
# beta<- c(-4,0)
# b <- X%*%beta * (1 - 1*sqrt(r))
# pnorm(Xbeta)- pnorm(Xbeta, b, sqrt(r))
beta<- c(0,0)
trace_beta<- numeric()
for(i in 1:200){
Xbeta  <- X%*%beta
# b <-  log(r)*(1 - 1*sqrt(r))
theta<- Xbeta
Z<- rtnorm(N, theta,sd = sqrt(r), lb, ub )
m<- X2inv%*% (t(X)%*% (Z))
beta <- cholX2inv%*%rnorm(2)*sqrt(r) + m
# if(i>100)
trace_beta<- rbind(trace_beta, t(beta))
}
# acf(trace_beta[,2],lag.max = 40)
#
ts.plot(trace_beta[,1])
# ts.plot(trace_beta[,2])
# acf(trace_beta[,1],lag.max = 40)
N<- 100
X0<- 1#rnorm(N, 1, 1)
X1<- rnorm(N, 1, 1)
X<- cbind(X0,X1)
beta<- c(-3,0)
theta<- pnorm(X%*%beta)
y<- as.numeric( runif(N)<theta)
sum(y)
vecInf<- rep(Inf, N)
X2inv<- solve(t(X)%*%X)
cholX2inv<- t(chol(X2inv))
lb<- -vecInf
ub<- vecInf
lb[y==1]<- 0
ub[y==0]<- 0
# pnorm(qnorm(1/N))
# pnorm(qnorm(1/N), b, sqrt(r))
# r<- 0.1
r<- 1
# r<-1
# beta<- c(-4,0)
# b <- X%*%beta * (1 - 1*sqrt(r))
# pnorm(Xbeta)- pnorm(Xbeta, b, sqrt(r))
beta<- c(0,0)
trace_beta<- numeric()
for(i in 1:200){
Xbeta  <- X%*%beta
# b <-  log(r)*(1 - 1*sqrt(r))
theta<- Xbeta
Z<- rtnorm(N, theta,sd = sqrt(r), lb, ub )
m<- X2inv%*% (t(X)%*% (Z))
beta <- cholX2inv%*%rnorm(2)*sqrt(r) + m
# if(i>100)
trace_beta<- rbind(trace_beta, t(beta))
}
# acf(trace_beta[,2],lag.max = 40)
#
ts.plot(trace_beta[,1])
# ts.plot(trace_beta[,2])
# acf(trace_beta[,1],lag.max = 40)
N<- 100
X0<- 1#rnorm(N, 1, 1)
X1<- rnorm(N, 1, 1)
X<- cbind(X0,X1)
beta<- c(-3,0)
theta<- pnorm(X%*%beta)
y<- as.numeric( runif(N)<theta)
sum(y)
vecInf<- rep(Inf, N)
X2inv<- solve(t(X)%*%X)
cholX2inv<- t(chol(X2inv))
lb<- -vecInf
ub<- vecInf
lb[y==1]<- 0
ub[y==0]<- 0
# pnorm(qnorm(1/N))
# pnorm(qnorm(1/N), b, sqrt(r))
# r<- 0.1
r<- 1
# r<-1
# beta<- c(-4,0)
# b <- X%*%beta * (1 - 1*sqrt(r))
# pnorm(Xbeta)- pnorm(Xbeta, b, sqrt(r))
beta<- c(0,0)
trace_beta<- numeric()
for(i in 1:200){
Xbeta  <- X%*%beta
# b <-  log(r)*(1 - 1*sqrt(r))
theta<- Xbeta
Z<- rtnorm(N, theta,sd = sqrt(r), lb, ub )
m<- X2inv%*% (t(X)%*% (Z))
beta <- cholX2inv%*%rnorm(2)*sqrt(r) + m
# if(i>100)
trace_beta<- rbind(trace_beta, t(beta))
}
# acf(trace_beta[,2],lag.max = 40)
#
ts.plot(trace_beta[,1])
# ts.plot(trace_beta[,2])
# acf(trace_beta[,1],lag.max = 40)
N<- 100
X0<- 1#rnorm(N, 1, 1)
X1<- rnorm(N, 1, 1)
X<- cbind(X0,X1)
beta<- c(-3,0)
theta<- pnorm(X%*%beta)
y<- as.numeric( runif(N)<theta)
sum(y)
vecInf<- rep(Inf, N)
X2inv<- solve(t(X)%*%X)
cholX2inv<- t(chol(X2inv))
lb<- -vecInf
ub<- vecInf
lb[y==1]<- 0
ub[y==0]<- 0
# pnorm(qnorm(1/N))
# pnorm(qnorm(1/N), b, sqrt(r))
# r<- 0.1
r<- 1
# r<-1
# beta<- c(-4,0)
# b <- X%*%beta * (1 - 1*sqrt(r))
# pnorm(Xbeta)- pnorm(Xbeta, b, sqrt(r))
beta<- c(0,0)
trace_beta<- numeric()
for(i in 1:200){
Xbeta  <- X%*%beta
# b <-  log(r)*(1 - 1*sqrt(r))
theta<- Xbeta
Z<- rtnorm(N, theta,sd = sqrt(r), lb, ub )
m<- X2inv%*% (t(X)%*% (Z))
beta <- cholX2inv%*%rnorm(2)*sqrt(r) + m
# if(i>100)
trace_beta<- rbind(trace_beta, t(beta))
}
# acf(trace_beta[,2],lag.max = 40)
#
ts.plot(trace_beta[,1])
# ts.plot(trace_beta[,2])
# acf(trace_beta[,1],lag.max = 40)
N<- 100
X0<- 1#rnorm(N, 1, 1)
X1<- rnorm(N, 1, 1)
X<- cbind(X0,X1)
beta<- c(-3,0)
theta<- pnorm(X%*%beta)
y<- as.numeric( runif(N)<theta)
sum(y)
vecInf<- rep(Inf, N)
X2inv<- solve(t(X)%*%X)
cholX2inv<- t(chol(X2inv))
lb<- -vecInf
ub<- vecInf
lb[y==1]<- 0
ub[y==0]<- 0
# pnorm(qnorm(1/N))
# pnorm(qnorm(1/N), b, sqrt(r))
# r<- 0.1
r<- 1
# r<-1
# beta<- c(-4,0)
# b <- X%*%beta * (1 - 1*sqrt(r))
# pnorm(Xbeta)- pnorm(Xbeta, b, sqrt(r))
beta<- c(0,0)
trace_beta<- numeric()
for(i in 1:200){
Xbeta  <- X%*%beta
# b <-  log(r)*(1 - 1*sqrt(r))
theta<- Xbeta
Z<- rtnorm(N, theta,sd = sqrt(r), lb, ub )
m<- X2inv%*% (t(X)%*% (Z))
beta <- cholX2inv%*%rnorm(2)*sqrt(r) + m
# if(i>100)
trace_beta<- rbind(trace_beta, t(beta))
}
# acf(trace_beta[,2],lag.max = 40)
#
ts.plot(trace_beta[,1])
# ts.plot(trace_beta[,2])
# acf(trace_beta[,1],lag.max = 40)
require("ImbalancedPG")
N<- 1E4
X0<- 1#rnorm(N, 1, 1)
X1<- rnorm(N, 0, 1)
X<- cbind(X0,X1)
beta<- c(1,-5)
Xbeta<- X%*%beta
theta<-  exp(Xbeta)/(1+exp(Xbeta))
y<- as.numeric(runif(N)<theta)
sum(y)
B<- diag(1000,2,2)
b<- rep(0,2)
fit<- ImbalancedPG::logit_reg_simple(y , X,b,B,r0 = 1.5)
fit$beta
acf(fit$beta[,1])
acf(fit$beta[,2])
# hist(fit$beta[,1])
fit$beta
ts.plot(fit$beta)
fit<- ImbalancedPG::logit_reg_simple(y , X,b,B,r0 = 10)
fit$beta
acf(fit$beta[,1])
acf(fit$beta[,2])
# hist(fit$beta[,1])
# hist(fit$beta[,2])
sd(fit$beta[,1])
sd(fit$beta[,2])
ts.plot(fit$beta)
fit$w
fit$w[,1]
sd(fit$w[,1])
x<- rnorm(100,0)
N<-100
x<- rnorm(N,0)
y<- rnorm(N, x, 1)
cor(y,x)
y<- rnorm(N, x, 10)
cor(y,x)
y<- rnorm(N, x, 100)
cor(y,x)
y<- rnorm(N, x, 1000)
cor(y,x)
y<- rnorm(N, x, 1000)
cor(y,x)
y<- rnorm(N, x, 1000)
cor(y,x)
y<- rnorm(N, x, 1000)
cor(y,x)
N<-1000
x<- rnorm(N,0)
y<- rnorm(N, x, 1000)
cor(y,x)
cor(y,x)
y<- rnorm(N, x, 1)
cor(y,x)
cov(y,x)
y<- rnorm(N, x, 100)
cov(y,x)
y<- rnorm(N, x, 100)
cov(y,x)
cor(y,x)
y<- rnorm(N, x, 100)
cor(y,x)
